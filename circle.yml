machine:
  ruby:
    version: 2.2.3
  node:
    version: 0.10.22
  services:
    # - docker
  environment:
    LC_ALL: en_US.UTF-8
    LANG: en_US.UTF-8
    LANGUAGE: en_US.UTF-8
    TOP_LVL_DIR: ~/repos
    ORG_NAME: mikesive
    API_KEY: $BLISS_API_KEY
    BLISS_HOST: $BLISS_HOST
    # DOCKER_OPTS: "-s devicemapper"
dependencies:
  cache_directories:
    - ~/nvm
    - "node_modules"
    - ~/bliss
    - ~/repos
    # - "~/docker"
  pre:
    - sudo locale-gen en_US.UTF-8
    - npm install -g jshint
    - npm install -g jshint-json
    - mkdir_p ~/repos
    - if [[ -e ~/bliss-php-test ]]; then git clone https://mikesive@bitbucket.org/mikesive/bliss-php-test.git ~/repos/bliss-php-test; fi
  override:
    - bundle check --path=vendor/bundle || bundle install --path=vendor/bundle --jobs=4 --retry=3
    # - if [[ -e ~/docker/image.tar ]]; then docker load -i ~/docker/image.tar; fi
    # - docker build -t blissai/collector .
    # - mkdir -p ~/docker; docker save blissai/collector > ~/docker/image.tar
# deployment:
  # hub:
    # branch: master
    # commands:
      # - sudo service docker restart
      # - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
      # - docker push blissai/collector
