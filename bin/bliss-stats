#!/usr/bin/env ruby
$LOAD_PATH << '../lib'
require_relative '../lib/bootstrap'
include Cmd
@args = ARGV
at_exit do
  unless $!.nil? || $!.is_a?(SystemExit) && $!.success?
    logger = BlissLogger.new(nil, nil, 'DockerError')
    logger.error("#{$!.backtrace}\n#{$!.message}", $!.class)
  end
end
stats = LocalStats.new(arg('dir'), arg('commit'), arg('log'), arg('excluded_dirs'),
                       arg('repo_test_files'), arg('repo_test_dirs'),
                       arg('excluded_exts'),
                       arg('remove_open_source') == 'true')
stats.execute
